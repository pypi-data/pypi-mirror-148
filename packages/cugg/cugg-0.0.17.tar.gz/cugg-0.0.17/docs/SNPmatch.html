---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/06_SNPmatch.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_SNPmatch.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install biopython</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Two-scenarios">Two scenarios<a class="anchor-link" href="#Two-scenarios"> </a></h2><ol>
<li>one dataset (vcf) be used in different softwares (regenie and fine mapping). we only need to consider flip and all snps in sumstat must be in genodata.</li>
<li>two datasets. They may have strand flips and reverse reference alleles, or both. So we need to consider all kinds of issues. I think the best way is to show all the potential results
 (multi SNPs in one postion and SNPs more than one base) and print a summary result, which we may get some very important info in there.</li>
</ol>
<p>For region extraction case, I think we only need to consider scenario 1, which make genotype consistent in different softwares by shifting the sign of beta in sumstats.
For merging exome and imput data, it is not necessary to consider the SNPs' overlapping in defferent datasets. If two SNPs are the same, both of them will be show in a credit set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_indels" class="doc_header"><code>check_indels</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_indels</code>(<strong><code>query</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_yaml" class="doc_header"><code>load_yaml</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_yaml</code>(<strong><code>yaml_file</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_input" class="doc_header"><code>parse_input</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L39" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_input</code>(<strong><code>yml_input</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match_ss_with_bim" class="doc_header"><code>match_ss_with_bim</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match_ss_with_bim</code>(<strong><code>query</code></strong>, <strong><code>subject</code></strong>)</p>
</blockquote>
<p>snp match case in one dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_ss" class="doc_header"><code>check_ss</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_ss</code>(<strong><code>ss</code></strong>, <strong><code>bim</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compare_snps" class="doc_header"><code>compare_snps</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compare_snps</code>(<strong><code>query</code></strong>, <strong><code>subject</code></strong>, <strong><code>only_match</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>input: query and subject, two data frame with the first five column: chr, pos, snp, a0, a1
output: data frame included six boolean columns (keep,exact,flip,reverse,both, complement) and two columns of the index query and subject.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="allele_match" class="doc_header"><code>allele_match</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>allele_match</code>(<strong><code>a0</code></strong>, <strong><code>a1</code></strong>, <strong><code>ref0</code></strong>, <strong><code>ref1</code></strong>)</p>
</blockquote>
<p>input: a0 and a1 are the first snp, ref0 and ref1 are the second snp.
output: keep,exact,flip,reverse,both, complement. boolean values.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_ss1" class="doc_header"><code>check_ss1</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L170" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_ss1</code>(<strong><code>ss</code></strong>, <strong><code>bim</code></strong>, <strong><code>keep_ambiguous</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>index by chr+por+ordered ref and alt</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pair_match" class="doc_header"><code>pair_match</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L205" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pair_match</code>(<strong><code>a1</code></strong>, <strong><code>a2</code></strong>, <strong><code>ref1</code></strong>, <strong><code>ref2</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="strand_flip" class="doc_header"><code>strand_flip</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L225" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>strand_flip</code>(<strong><code>s</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="namebyordA0_A1" class="doc_header"><code>namebyordA0_A1</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L227" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>namebyordA0_A1</code>(<strong><code>df</code></strong>, <strong><code>cols</code></strong>=<em><code>['CHR', 'POS', 'A0', 'A1']</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="snps_match" class="doc_header"><code>snps_match</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L237" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>snps_match</code>(<strong><code>query</code></strong>, <strong><code>subject</code></strong>, <strong><code>keep_ambiguous</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="snps_match_dup" class="doc_header"><code>snps_match_dup</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L260" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>snps_match_dup</code>(<strong><code>query</code></strong>, <strong><code>subject</code></strong>, <strong><code>keep_ambiguous</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="snps_match_nodup" class="doc_header"><code>snps_match_nodup</code><a href="https://github.com/changebio/cugg/tree/master/cugg/utils.py#L270" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>snps_match_nodup</code>(<strong><code>query</code></strong>, <strong><code>subject</code></strong>, <strong><code>keep_ambiguous</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Testing-snps_match">2. Testing snps_match<a class="anchor-link" href="#2.-Testing-snps_match"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.Testing-check_ss1-function">1.Testing check_ss1 function<a class="anchor-link" href="#1.Testing-check_ss1-function"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">272741</span><span class="p">,</span><span class="mi">1213528</span><span class="p">]</span>
<span class="n">geno_path</span> <span class="o">=</span> <span class="s1">&#39;../MWE_region_extraction/ukb23156_c5.merged.filtered.5_272741_1213528.bed&#39;</span>
<span class="n">sumstats_path</span> <span class="o">=</span> <span class="s1">&#39;../MWE_region_extraction/090321_UKBB_Hearing_aid_f3393_expandedwhite_6436cases_96601ctrl_PC1_2_f3393.regenie.snp_stats&#39;</span>
<span class="n">pheno_path</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">unr_path</span> <span class="o">=</span> <span class="s1">&#39;MWE_region_extraction/UKB_genotypedatadownloaded083019.090221_sample_variant_qc_final_callrate90.filtered.extracted.white_europeans.filtered.092821_ldprun_unrelated.filtered.prune.txt&#39;</span>
<span class="n">imp_geno_path</span> <span class="o">=</span> <span class="s1">&#39;../MWE_region_extraction/ukb_imp_chr5_v3_05_272856_1213643.bgen&#39;</span>
<span class="n">imp_sumstats_path</span> <span class="o">=</span> <span class="s1">&#39;../MWE_region_extraction/100521_UKBB_Hearing_aid_f3393_expandedwhite_15601cases_237318ctrl_500k_PC1_PC2_f3393.regenie.snp_stats.gz&#39;</span>
<span class="n">imp_ref</span> <span class="o">=</span> <span class="s1">&#39;hg19&#39;</span>
<span class="n">bgen_sample_path</span> <span class="o">=</span> <span class="s1">&#39;../MWE_region_extraction/ukb_imp_chr5_v3_05_272856_1213643.sample&#39;</span>
<span class="n">output_sumstats</span> <span class="o">=</span> <span class="s1">&#39;test.snp_stats.gz&#39;</span>
<span class="n">output_LD</span> <span class="o">=</span> <span class="s1">&#39;test_corr.csv.gz&#39;</span>

<span class="c1">#main(region,geno_path,sumstats_path,pheno_path,unr_path,imp_geno_path,imp_sumstats_path,imp_ref,output_sumstats,output_LD)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imp_geno_path</span> <span class="o">=</span> <span class="s1">&#39;/mnt/mfs/statgen/archive/UKBiobank_Yale_transfer/ukb39554_imputeddataset/ukb_imp_chr5_v3.bgen&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exome_sumstats</span> <span class="o">=</span> <span class="n">Sumstat</span><span class="p">(</span><span class="n">sumstats_path</span><span class="p">)</span>
<span class="n">exome_sumstats</span><span class="o">.</span><span class="n">extractbyregion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>this region [5, 272741, 1213528] has 3884 SNPs in Sumstat
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5:272741_G:A</th>
      <td>5</td>
      <td>272741</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:272741:A:G</td>
      <td>1.789340</td>
      <td>0.250526</td>
      <td>7.055048e-11</td>
    </tr>
    <tr>
      <th>5:272748_G:C</th>
      <td>5</td>
      <td>272748</td>
      <td>G</td>
      <td>C</td>
      <td>chr5:272748:G:C</td>
      <td>1.698750</td>
      <td>0.279645</td>
      <td>2.479648e-08</td>
    </tr>
    <tr>
      <th>5:272755_G:A</th>
      <td>5</td>
      <td>272755</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:272755:A:G</td>
      <td>1.708990</td>
      <td>0.242533</td>
      <td>1.335826e-10</td>
    </tr>
    <tr>
      <th>5:272758_G:A</th>
      <td>5</td>
      <td>272758</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:272758:A:G</td>
      <td>-1.285990</td>
      <td>1.782120</td>
      <td>4.705362e-01</td>
    </tr>
    <tr>
      <th>5:272771_G:C</th>
      <td>5</td>
      <td>272771</td>
      <td>C</td>
      <td>G</td>
      <td>chr5:272771:C:G</td>
      <td>1.620460</td>
      <td>0.466804</td>
      <td>1.956681e-03</td>
    </tr>
    <tr>
      <th>5:272791_C:A</th>
      <td>5</td>
      <td>272791</td>
      <td>A</td>
      <td>C</td>
      <td>chr5:272791:A:C</td>
      <td>0.014049</td>
      <td>0.071979</td>
      <td>8.452456e-01</td>
    </tr>
    <tr>
      <th>5:272816_T:C</th>
      <td>5</td>
      <td>272816</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:272816:C:T</td>
      <td>-0.259206</td>
      <td>0.276487</td>
      <td>3.485018e-01</td>
    </tr>
    <tr>
      <th>5:272822_T:G</th>
      <td>5</td>
      <td>272822</td>
      <td>T</td>
      <td>G</td>
      <td>chr5:272822:T:G</td>
      <td>-1.267800</td>
      <td>1.258490</td>
      <td>3.137451e-01</td>
    </tr>
    <tr>
      <th>5:272829_T:C</th>
      <td>5</td>
      <td>272829</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:272829:T:C</td>
      <td>0.301320</td>
      <td>0.878689</td>
      <td>7.316595e-01</td>
    </tr>
    <tr>
      <th>5:275930_G:A</th>
      <td>5</td>
      <td>275930</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:275930:G:A</td>
      <td>-0.379434</td>
      <td>0.533934</td>
      <td>4.773083e-01</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">namebyordA0_A1</span><span class="p">(</span><span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">[[</span><span class="s1">&#39;CHR&#39;</span><span class="p">,</span><span class="s1">&#39;POS&#39;</span><span class="p">,</span><span class="s1">&#39;REF&#39;</span><span class="p">,</span><span class="s1">&#39;ALT&#39;</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0        [5:272741, G:A]
1        [5:272748, G:C]
2        [5:272755, G:A]
3        [5:272758, G:A]
4        [5:272771, G:C]
              ...       
3879    [5:1213517, T:C]
3880    [5:1213518, G:A]
3881    [5:1213524, T:C]
3882    [5:1213527, T:C]
3883    [5:1213528, G:A]
Length: 3884, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">index</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;5:272741_G:A&#39;, &#39;5:272748_G:C&#39;, &#39;5:272755_G:A&#39;, &#39;5:272758_G:A&#39;,
       &#39;5:272771_G:C&#39;, &#39;5:272791_C:A&#39;, &#39;5:272816_T:C&#39;, &#39;5:272822_T:G&#39;,
       &#39;5:272829_T:C&#39;, &#39;5:275930_G:A&#39;,
       ...
       &#39;5:1213465_T:C&#39;, &#39;5:1213471_T:C&#39;, &#39;5:1213482_T:C&#39;, &#39;5:1213483_G:A&#39;,
       &#39;5:1213495_T:C&#39;, &#39;5:1213517_T:C&#39;, &#39;5:1213518_G:A&#39;, &#39;5:1213524_T:C&#39;,
       &#39;5:1213527_T:C&#39;, &#39;5:1213528_G:A&#39;],
      dtype=&#39;object&#39;, length=3884)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;5&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;ab_c&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;ab&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ True,  True,  True, ...,  True,  True,  True])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;5:432782_TC:T&#39;, &#39;5:432782_TC:T&#39;, &#39;5:473309_AGCG:A&#39;, &#39;5:473309_AGCG:A&#39;,
       &#39;5:612613_AC:A&#39;, &#39;5:612613_AC:A&#39;, &#39;5:665193_GCCTTGC:G&#39;,
       &#39;5:665193_GCCTTGC:G&#39;, &#39;5:692497_GC:G&#39;, &#39;5:692497_GC:G&#39;, &#39;5:889546_AC:A&#39;,
       &#39;5:889546_AC:A&#39;, &#39;5:891687_ACTT:A&#39;, &#39;5:891687_ACTT:A&#39;, &#39;5:912005_AT:A&#39;,
       &#39;5:912005_AT:A&#39;, &#39;5:1035376_AC:A&#39;, &#39;5:1035376_AC:A&#39;,
       &#39;5:1038307_GCACGAGCACCACCACCAC:G&#39;, &#39;5:1038307_GCACGAGCACCACCACCAC:G&#39;,
       &#39;5:1038331_GCAC:G&#39;, &#39;5:1038331_GCACCAC:G&#39;, &#39;5:1038331_GCAC:G&#39;,
       &#39;5:1038331_GCACCACCAC:G&#39;, &#39;5:1038331_GCACCAC:G&#39;,
       &#39;5:1038331_GCACCACCAC:G&#39;, &#39;5:1056514_CCA:C&#39;, &#39;5:1056514_CCA:C&#39;,
       &#39;5:1112017_TCCCGG:T&#39;, &#39;5:1112017_TCCCGG:T&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;5:272741&#39;, &#39;G:A&#39;],
 [&#39;5:272748&#39;, &#39;G:C&#39;],
 [&#39;5:272755&#39;, &#39;G:A&#39;],
 [&#39;5:272758&#39;, &#39;G:A&#39;],
 [&#39;5:272771&#39;, &#39;G:C&#39;],
 [&#39;5:272791&#39;, &#39;C:A&#39;],
 [&#39;5:272816&#39;, &#39;T:C&#39;],
 [&#39;5:272822&#39;, &#39;T:G&#39;],
 [&#39;5:272829&#39;, &#39;T:C&#39;],
 [&#39;5:275930&#39;, &#39;G:A&#39;]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    5:272741
1    5:272748
2    5:272755
3    5:272758
4    5:272771
5    5:272791
6    5:272816
7    5:272822
8    5:272829
9    5:275930
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exome_geno</span> <span class="o">=</span> <span class="n">Genodata</span><span class="p">(</span><span class="n">geno_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bim</span> <span class="o">=</span> <span class="n">exome_geno</span><span class="o">.</span><span class="n">bim</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_ss1</span><span class="p">(</span><span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">,</span><span class="n">bim</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Paired SNPs 3847
Warning: there are 402 ambiguous SNPs
Overlap SNPs 3847
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/2206559.1.plot.q/ipykernel_14021/227429081.py:31: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  new_query.BETA[pm.sign_flip] = -new_query.BETA[pm.sign_flip]
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5:272741:G:A</th>
      <td>5</td>
      <td>272741</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:272741:G:A</td>
      <td>-1.789340</td>
      <td>0.250526</td>
      <td>7.055048e-11</td>
    </tr>
    <tr>
      <th>5:272748:G:C</th>
      <td>5</td>
      <td>272748</td>
      <td>C</td>
      <td>G</td>
      <td>chr5:272748:C:G</td>
      <td>-1.698750</td>
      <td>0.279645</td>
      <td>2.479648e-08</td>
    </tr>
    <tr>
      <th>5:272755:G:A</th>
      <td>5</td>
      <td>272755</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:272755:G:A</td>
      <td>-1.708990</td>
      <td>0.242533</td>
      <td>1.335826e-10</td>
    </tr>
    <tr>
      <th>5:272758:G:A</th>
      <td>5</td>
      <td>272758</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:272758:G:A</td>
      <td>1.285990</td>
      <td>1.782120</td>
      <td>4.705362e-01</td>
    </tr>
    <tr>
      <th>5:272771:G:C</th>
      <td>5</td>
      <td>272771</td>
      <td>G</td>
      <td>C</td>
      <td>chr5:272771:G:C</td>
      <td>-1.620460</td>
      <td>0.466804</td>
      <td>1.956681e-03</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5:1213517:T:C</th>
      <td>5</td>
      <td>1213517</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:1213517:T:C</td>
      <td>1.093870</td>
      <td>1.988000</td>
      <td>5.821595e-01</td>
    </tr>
    <tr>
      <th>5:1213518:G:A</th>
      <td>5</td>
      <td>1213518</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:1213518:A:G</td>
      <td>1.221880</td>
      <td>1.772910</td>
      <td>4.906999e-01</td>
    </tr>
    <tr>
      <th>5:1213524:T:C</th>
      <td>5</td>
      <td>1213524</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213524:C:T</td>
      <td>-0.151751</td>
      <td>0.664055</td>
      <td>8.192405e-01</td>
    </tr>
    <tr>
      <th>5:1213527:T:C</th>
      <td>5</td>
      <td>1213527</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:1213527:T:C</td>
      <td>1.080770</td>
      <td>1.865680</td>
      <td>5.623918e-01</td>
    </tr>
    <tr>
      <th>5:1213528:G:A</th>
      <td>5</td>
      <td>1213528</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:1213528:A:G</td>
      <td>1.057160</td>
      <td>2.654680</td>
      <td>6.904639e-01</td>
    </tr>
  </tbody>
</table>
<p>3847 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imput_sumstats</span> <span class="o">=</span> <span class="n">Sumstat</span><span class="p">(</span><span class="n">imp_sumstats_path</span><span class="p">)</span>
<span class="n">imput_geno</span> <span class="o">=</span> <span class="n">Genodata</span><span class="p">(</span><span class="n">imp_geno_path</span><span class="p">,</span><span class="n">bgen_sample_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_ss1</span><span class="p">(</span><span class="n">imput_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">,</span><span class="n">imput_geno</span><span class="o">.</span><span class="n">bim</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Paired SNPs 632
Warning: there are 85 ambiguous SNPs
Overlap SNPs 632
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/2206559.1.plot.q/ipykernel_3137/3698415862.py:34: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  new_query.BETA[pm.sign_flip] = -new_query.BETA[pm.sign_flip]
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5:73072354:T:C</th>
      <td>5</td>
      <td>73072354</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:73072354:T:C</td>
      <td>0.101991</td>
      <td>0.012277</td>
      <td>1.073001e-16</td>
    </tr>
    <tr>
      <th>5:73072504:C:A</th>
      <td>5</td>
      <td>73072504</td>
      <td>A</td>
      <td>C</td>
      <td>chr5:73072504:A:C</td>
      <td>0.015024</td>
      <td>0.036310</td>
      <td>6.790301e-01</td>
    </tr>
    <tr>
      <th>5:73072530:G:A</th>
      <td>5</td>
      <td>73072530</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73072530:A:G</td>
      <td>0.095930</td>
      <td>0.050772</td>
      <td>5.883557e-02</td>
    </tr>
    <tr>
      <th>5:73072863:G:A</th>
      <td>5</td>
      <td>73072863</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:73072863:G:A</td>
      <td>-0.072351</td>
      <td>0.667580</td>
      <td>9.136960e-01</td>
    </tr>
    <tr>
      <th>5:73072873:G:A</th>
      <td>5</td>
      <td>73072873</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73072873:A:G</td>
      <td>0.042773</td>
      <td>0.543868</td>
      <td>9.373146e-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5:73144301:T:C</th>
      <td>5</td>
      <td>73144301</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:73144301:T:C</td>
      <td>0.079786</td>
      <td>0.012277</td>
      <td>8.143292e-11</td>
    </tr>
    <tr>
      <th>5:73144431:TAG:T</th>
      <td>5</td>
      <td>73144431</td>
      <td>TAG</td>
      <td>T</td>
      <td>chr5:73144431:TAG:T</td>
      <td>0.029964</td>
      <td>0.023528</td>
      <td>2.028154e-01</td>
    </tr>
    <tr>
      <th>5:73144432:G:A</th>
      <td>5</td>
      <td>73144432</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73144432:A:G</td>
      <td>0.088728</td>
      <td>0.012569</td>
      <td>1.627796e-12</td>
    </tr>
    <tr>
      <th>5:73144716:G:A</th>
      <td>5</td>
      <td>73144716</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:73144716:G:A</td>
      <td>0.300375</td>
      <td>0.575205</td>
      <td>6.015282e-01</td>
    </tr>
    <tr>
      <th>5:73144845:G:A</th>
      <td>5</td>
      <td>73144845</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73144845:A:G</td>
      <td>0.090138</td>
      <td>0.012494</td>
      <td>5.022269e-13</td>
    </tr>
  </tbody>
</table>
<p>632 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5:73072354:T:C</th>
      <td>5</td>
      <td>73072354</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:73072354:T:C</td>
      <td>0.101991</td>
      <td>0.012277</td>
      <td>1.073001e-16</td>
    </tr>
    <tr>
      <th>5:73072504:C:A</th>
      <td>5</td>
      <td>73072504</td>
      <td>A</td>
      <td>C</td>
      <td>chr5:73072504:A:C</td>
      <td>0.015024</td>
      <td>0.036310</td>
      <td>6.790301e-01</td>
    </tr>
    <tr>
      <th>5:73072530:G:A</th>
      <td>5</td>
      <td>73072530</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73072530:A:G</td>
      <td>0.095930</td>
      <td>0.050772</td>
      <td>5.883557e-02</td>
    </tr>
    <tr>
      <th>5:73072863:G:A</th>
      <td>5</td>
      <td>73072863</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:73072863:G:A</td>
      <td>-0.072351</td>
      <td>0.667580</td>
      <td>9.136960e-01</td>
    </tr>
    <tr>
      <th>5:73072873:G:A</th>
      <td>5</td>
      <td>73072873</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73072873:A:G</td>
      <td>0.042773</td>
      <td>0.543868</td>
      <td>9.373146e-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5:73144301:T:C</th>
      <td>5</td>
      <td>73144301</td>
      <td>T</td>
      <td>C</td>
      <td>chr5:73144301:T:C</td>
      <td>0.079786</td>
      <td>0.012277</td>
      <td>8.143292e-11</td>
    </tr>
    <tr>
      <th>5:73144431:TAG:T</th>
      <td>5</td>
      <td>73144431</td>
      <td>TAG</td>
      <td>T</td>
      <td>chr5:73144431:TAG:T</td>
      <td>0.029964</td>
      <td>0.023528</td>
      <td>2.028154e-01</td>
    </tr>
    <tr>
      <th>5:73144432:G:A</th>
      <td>5</td>
      <td>73144432</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73144432:A:G</td>
      <td>0.088728</td>
      <td>0.012569</td>
      <td>1.627796e-12</td>
    </tr>
    <tr>
      <th>5:73144716:G:A</th>
      <td>5</td>
      <td>73144716</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:73144716:G:A</td>
      <td>0.300375</td>
      <td>0.575205</td>
      <td>6.015282e-01</td>
    </tr>
    <tr>
      <th>5:73144845:G:A</th>
      <td>5</td>
      <td>73144845</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:73144845:A:G</td>
      <td>0.090138</td>
      <td>0.012494</td>
      <td>5.022269e-13</td>
    </tr>
  </tbody>
</table>
<p>632 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>snp</th>
      <th>cm</th>
      <th>pos</th>
      <th>a0</th>
      <th>a1</th>
      <th>i</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5:73072354:T:C</th>
      <td>5</td>
      <td>chr5:73072354:T:C</td>
      <td>0.0</td>
      <td>73072354</td>
      <td>T</td>
      <td>C</td>
      <td>2401738</td>
    </tr>
    <tr>
      <th>5:73072371:T:C</th>
      <td>5</td>
      <td>chr5:73072371:C:T</td>
      <td>0.0</td>
      <td>73072371</td>
      <td>C</td>
      <td>T</td>
      <td>2401739</td>
    </tr>
    <tr>
      <th>5:73072425:G:A</th>
      <td>5</td>
      <td>chr5:73072425:G:A</td>
      <td>0.0</td>
      <td>73072425</td>
      <td>G</td>
      <td>A</td>
      <td>2401740</td>
    </tr>
    <tr>
      <th>5:73072501:T:G</th>
      <td>5</td>
      <td>chr5:73072501:G:T</td>
      <td>0.0</td>
      <td>73072501</td>
      <td>G</td>
      <td>T</td>
      <td>2401741</td>
    </tr>
    <tr>
      <th>5:73072504:C:A</th>
      <td>5</td>
      <td>chr5:73072504:A:C</td>
      <td>0.0</td>
      <td>73072504</td>
      <td>A</td>
      <td>C</td>
      <td>2401742</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5:73144742:G:A</th>
      <td>5</td>
      <td>chr5:73144742:G:A</td>
      <td>0.0</td>
      <td>73144742</td>
      <td>G</td>
      <td>A</td>
      <td>2404138</td>
    </tr>
    <tr>
      <th>5:73144750:G:A</th>
      <td>5</td>
      <td>chr5:73144750:A:G</td>
      <td>0.0</td>
      <td>73144750</td>
      <td>A</td>
      <td>G</td>
      <td>2404139</td>
    </tr>
    <tr>
      <th>5:73144765:G:A</th>
      <td>5</td>
      <td>chr5:73144765:A:G</td>
      <td>0.0</td>
      <td>73144765</td>
      <td>A</td>
      <td>G</td>
      <td>2404140</td>
    </tr>
    <tr>
      <th>5:73144823:G:A</th>
      <td>5</td>
      <td>chr5:73144823:G:A</td>
      <td>0.0</td>
      <td>73144823</td>
      <td>G</td>
      <td>A</td>
      <td>2404141</td>
    </tr>
    <tr>
      <th>5:73144845:G:A</th>
      <td>5</td>
      <td>chr5:73144845:A:G</td>
      <td>0.0</td>
      <td>73144845</td>
      <td>A</td>
      <td>G</td>
      <td>2404142</td>
    </tr>
  </tbody>
</table>
<p>2405 rows × 7 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imput_sumstats</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>sumstat:                  CHR       POS  REF ALT                  SNP      BETA  \
5:73072354:T:C      5  73072354    T   C    chr5:73072354:T:C  0.101991   
5:73072504:C:A      5  73072504    A   C    chr5:73072504:A:C  0.015024   
5:73072530:G:A      5  73072530    A   G    chr5:73072530:A:G  0.095930   
5:73072863:G:A      5  73072863    G   A    chr5:73072863:G:A -0.072351   
5:73072873:G:A      5  73072873    A   G    chr5:73072873:A:G  0.042773   
...               ...       ...  ...  ..                  ...       ...   
5:73144301:T:C      5  73144301    T   C    chr5:73144301:T:C  0.079786   
5:73144431:TAG:T    5  73144431  TAG   T  chr5:73144431:TAG:T  0.029964   
5:73144432:G:A      5  73144432    A   G    chr5:73144432:A:G  0.088728   
5:73144716:G:A      5  73144716    G   A    chr5:73144716:G:A  0.300375   
5:73144845:G:A      5  73144845    A   G    chr5:73144845:A:G  0.090138   

                        SE             P  
5:73072354:T:C    0.012277  1.073001e-16  
5:73072504:C:A    0.036310  6.790301e-01  
5:73072530:G:A    0.050772  5.883557e-02  
5:73072863:G:A    0.667580  9.136960e-01  
5:73072873:G:A    0.543868  9.373146e-01  
...                    ...           ...  
5:73144301:T:C    0.012277  8.143292e-11  
5:73144431:TAG:T  0.023528  2.028154e-01  
5:73144432:G:A    0.012569  1.627796e-12  
5:73144716:G:A    0.575205  6.015282e-01  
5:73144845:G:A    0.012494  5.022269e-13  

[632 rows x 8 columns]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">73776529</span><span class="p">,</span> <span class="mi">73849020</span><span class="p">]</span>
<span class="n">hg38toimpref</span> <span class="o">=</span> <span class="n">Liftover</span><span class="p">(</span><span class="s1">&#39;hg38&#39;</span><span class="p">,</span><span class="s1">&#39;hg19&#39;</span><span class="p">)</span>
<span class="n">imp_region</span> <span class="o">=</span> <span class="n">hg38toimpref</span><span class="o">.</span><span class="n">region_liftover</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">imput_sumstats</span><span class="o">.</span><span class="n">extractbyregion</span><span class="p">(</span><span class="n">imp_region</span><span class="p">)</span>
<span class="n">imput_geno</span><span class="o">.</span><span class="n">extractbyregion</span><span class="p">(</span><span class="n">imp_region</span><span class="p">)</span>
<span class="n">imput_sumstats</span><span class="o">.</span><span class="n">match_ss</span><span class="p">(</span><span class="n">imput_geno</span><span class="o">.</span><span class="n">bim</span><span class="p">)</span>
<span class="n">imput_geno</span><span class="o">.</span><span class="n">geno_in_stat</span><span class="p">(</span><span class="n">imput_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>this region (5, 73072354, 73144845) has 632 SNPs in Sumstat
this region (5, 73072354, 73144845) has 2405 SNPs in Genodata
Paired SNPs 632
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/2206559.1.plot.q/ipykernel_3137/2846184474.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> imput_sumstats<span class="ansi-blue-fg">.</span>extractbyregion<span class="ansi-blue-fg">(</span>imp_region<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> imput_geno<span class="ansi-blue-fg">.</span>extractbyregion<span class="ansi-blue-fg">(</span>imp_region<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg"> </span>imput_sumstats<span class="ansi-blue-fg">.</span>match_ss<span class="ansi-blue-fg">(</span>imput_geno<span class="ansi-blue-fg">.</span>bim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> imput_geno<span class="ansi-blue-fg">.</span>geno_in_stat<span class="ansi-blue-fg">(</span>imput_sumstats<span class="ansi-blue-fg">.</span>ss<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/mnt/mfs/statgen/yin/Github/LDtools/LDtools/sumstat.py</span> in <span class="ansi-cyan-fg">match_ss</span><span class="ansi-blue-fg">(self, bim)</span>
<span class="ansi-green-intense-fg ansi-bold">     61</span> 
<span class="ansi-green-intense-fg ansi-bold">     62</span>     <span class="ansi-green-fg">def</span> match_ss<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>bim<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 63</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>ss <span class="ansi-blue-fg">=</span> check_ss1<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>ss<span class="ansi-blue-fg">,</span>bim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     64</span> 

<span class="ansi-green-fg">/mnt/mfs/statgen/yin/Github/LDtools/LDtools/utils.py</span> in <span class="ansi-cyan-fg">check_ss1</span><span class="ansi-blue-fg">(ss, bim, keep_ambiguous)</span>
<span class="ansi-green-intense-fg ansi-bold">    153</span>     print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Paired SNPs&#34;</span><span class="ansi-blue-fg">,</span>ss<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    154</span>     <span class="ansi-red-fg">#input paired ss and bim</span>
<span class="ansi-green-fg">--&gt; 155</span><span class="ansi-red-fg">     </span>pm <span class="ansi-blue-fg">=</span> pair_match<span class="ansi-blue-fg">(</span>ss<span class="ansi-blue-fg">.</span>REF<span class="ansi-blue-fg">,</span>ss<span class="ansi-blue-fg">.</span>ALT<span class="ansi-blue-fg">,</span>bim<span class="ansi-blue-fg">.</span>a0<span class="ansi-blue-fg">,</span>bim<span class="ansi-blue-fg">.</span>a1<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>     <span class="ansi-green-fg">if</span> keep_ambiguous<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    157</span>         print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Warning: there are&#39;</span><span class="ansi-blue-fg">,</span>sum<span class="ansi-blue-fg">(</span>pm<span class="ansi-blue-fg">.</span>ambiguous<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;ambiguous SNPs&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/mnt/mfs/statgen/yin/Github/LDtools/LDtools/utils.py</span> in <span class="ansi-cyan-fg">pair_match</span><span class="ansi-blue-fg">(a1, a2, ref1, ref2)</span>
<span class="ansi-green-intense-fg ansi-bold">    183</span>     result<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;ambiguous&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;A&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;T&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">|</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;T&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;A&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">|</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;C&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;G&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">|</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;G&#34;</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#34;C&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span>     <span class="ansi-red-fg"># as long as scenario 1 is involved, sign_flip will return TRUE</span>
<span class="ansi-green-fg">--&gt; 185</span><span class="ansi-red-fg">     </span>result<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;sign_flip&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span>ref2<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span>ref1<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">|</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span>flip2<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span>flip1<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>     <span class="ansi-red-fg"># as long as scenario 2 is involved, strand_flip will return TRUE</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>     result<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;strand_flip&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span>flip1<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span>flip2<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">|</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">==</span>flip2<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&amp;</span> <span class="ansi-blue-fg">(</span>a2<span class="ansi-blue-fg">==</span>flip1<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.8/site-packages/pandas/core/ops/common.py</span> in <span class="ansi-cyan-fg">new_method</span><span class="ansi-blue-fg">(self, other)</span>
<span class="ansi-green-intense-fg ansi-bold">     67</span>         other <span class="ansi-blue-fg">=</span> item_from_zerodim<span class="ansi-blue-fg">(</span>other<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     68</span> 
<span class="ansi-green-fg">---&gt; 69</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> method<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> other<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     70</span> 
<span class="ansi-green-intense-fg ansi-bold">     71</span>     <span class="ansi-green-fg">return</span> new_method

<span class="ansi-green-fg">~/miniconda3/lib/python3.8/site-packages/pandas/core/arraylike.py</span> in <span class="ansi-cyan-fg">__eq__</span><span class="ansi-blue-fg">(self, other)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     <span class="ansi-blue-fg">@</span>unpack_zerodim_and_defer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;__eq__&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>     <span class="ansi-green-fg">def</span> __eq__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> other<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 32</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_cmp_method<span class="ansi-blue-fg">(</span>other<span class="ansi-blue-fg">,</span> operator<span class="ansi-blue-fg">.</span>eq<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-intense-fg ansi-bold">     34</span>     <span class="ansi-blue-fg">@</span>unpack_zerodim_and_defer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;__ne__&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.8/site-packages/pandas/core/series.py</span> in <span class="ansi-cyan-fg">_cmp_method</span><span class="ansi-blue-fg">(self, other, op)</span>
<span class="ansi-green-intense-fg ansi-bold">   5494</span> 
<span class="ansi-green-intense-fg ansi-bold">   5495</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>other<span class="ansi-blue-fg">,</span> Series<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>_indexed_same<span class="ansi-blue-fg">(</span>other<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 5496</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Can only compare identically-labeled Series objects&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   5497</span> 
<span class="ansi-green-intense-fg ansi-bold">   5498</span>         lvalues <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_values

<span class="ansi-red-fg">ValueError</span>: Can only compare identically-labeled Series objects</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">exome_sumstats</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span><span class="o">.</span><span class="n">REF</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ALT</span><span class="p">)</span>
<span class="n">aa</span><span class="o">.</span><span class="n">ALT</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">REF</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span><span class="n">compare_snps</span><span class="p">(</span><span class="n">imput_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">,</span><span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>keep   exact  flip   reverse  both   complement
False  False  False  False    False  False         8439
True   False  False  True     False  False           13
       True   False  False    False  False            9
       False  True   False    False  False            5
False  False  False  False    False  True             4
True   False  False  False    True   False            2
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keep</th>
      <th>exact</th>
      <th>flip</th>
      <th>reverse</th>
      <th>both</th>
      <th>complement</th>
      <th>qidx</th>
      <th>sidx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6767726</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6767727</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6767728</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6767729</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6767730</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8467</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6776191</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8468</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6776192</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8469</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6776193</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8470</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6776194</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>8471</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>6776195</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>8472 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imput_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">qidx</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">exact</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6767726</th>
      <td>5</td>
      <td>272851</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:272851:A:G</td>
      <td>0.357496</td>
      <td>0.888197</td>
      <td>0.687318</td>
    </tr>
    <tr>
      <th>6767727</th>
      <td>5</td>
      <td>272906</td>
      <td>A</td>
      <td>C</td>
      <td>chr5:272906:A:C</td>
      <td>-0.003007</td>
      <td>0.019764</td>
      <td>0.879070</td>
    </tr>
    <tr>
      <th>6767728</th>
      <td>5</td>
      <td>273143</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:273143:A:G</td>
      <td>-0.013693</td>
      <td>0.016716</td>
      <td>0.412684</td>
    </tr>
    <tr>
      <th>6767729</th>
      <td>5</td>
      <td>273160</td>
      <td>G</td>
      <td>C</td>
      <td>chr5:273160:G:C</td>
      <td>0.235713</td>
      <td>0.348772</td>
      <td>0.499145</td>
    </tr>
    <tr>
      <th>6767730</th>
      <td>5</td>
      <td>273534</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:273534:C:T</td>
      <td>0.050095</td>
      <td>0.139496</td>
      <td>0.719509</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6776191</th>
      <td>5</td>
      <td>1213094</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213094:C:T</td>
      <td>-0.015881</td>
      <td>0.023298</td>
      <td>0.495462</td>
    </tr>
    <tr>
      <th>6776192</th>
      <td>5</td>
      <td>1213134</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:1213134:G:A</td>
      <td>-1.142280</td>
      <td>1.344380</td>
      <td>0.395509</td>
    </tr>
    <tr>
      <th>6776193</th>
      <td>5</td>
      <td>1213223</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213223:C:T</td>
      <td>-0.003009</td>
      <td>0.013631</td>
      <td>0.825270</td>
    </tr>
    <tr>
      <th>6776194</th>
      <td>5</td>
      <td>1213404</td>
      <td>T</td>
      <td>TC</td>
      <td>chr5:1213404:T:TC</td>
      <td>-0.039146</td>
      <td>0.117837</td>
      <td>0.739735</td>
    </tr>
    <tr>
      <th>6776195</th>
      <td>5</td>
      <td>1213510</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213510:C:T</td>
      <td>0.009318</td>
      <td>0.012922</td>
      <td>0.470845</td>
    </tr>
  </tbody>
</table>
<p>8461 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imput_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">qidx</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">exact</span><span class="o">==</span><span class="kc">False</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6767726</th>
      <td>5</td>
      <td>272851</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:272851:A:G</td>
      <td>0.357496</td>
      <td>0.888197</td>
      <td>0.687318</td>
    </tr>
    <tr>
      <th>6767727</th>
      <td>5</td>
      <td>272906</td>
      <td>A</td>
      <td>C</td>
      <td>chr5:272906:A:C</td>
      <td>-0.003007</td>
      <td>0.019764</td>
      <td>0.879070</td>
    </tr>
    <tr>
      <th>6767728</th>
      <td>5</td>
      <td>273143</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:273143:A:G</td>
      <td>-0.013693</td>
      <td>0.016716</td>
      <td>0.412684</td>
    </tr>
    <tr>
      <th>6767729</th>
      <td>5</td>
      <td>273160</td>
      <td>G</td>
      <td>C</td>
      <td>chr5:273160:G:C</td>
      <td>0.235713</td>
      <td>0.348772</td>
      <td>0.499145</td>
    </tr>
    <tr>
      <th>6767730</th>
      <td>5</td>
      <td>273534</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:273534:C:T</td>
      <td>0.050095</td>
      <td>0.139496</td>
      <td>0.719509</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6776191</th>
      <td>5</td>
      <td>1213094</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213094:C:T</td>
      <td>-0.015881</td>
      <td>0.023298</td>
      <td>0.495462</td>
    </tr>
    <tr>
      <th>6776192</th>
      <td>5</td>
      <td>1213134</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:1213134:G:A</td>
      <td>-1.142280</td>
      <td>1.344380</td>
      <td>0.395509</td>
    </tr>
    <tr>
      <th>6776193</th>
      <td>5</td>
      <td>1213223</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213223:C:T</td>
      <td>-0.003009</td>
      <td>0.013631</td>
      <td>0.825270</td>
    </tr>
    <tr>
      <th>6776194</th>
      <td>5</td>
      <td>1213404</td>
      <td>T</td>
      <td>TC</td>
      <td>chr5:1213404:T:TC</td>
      <td>-0.039146</td>
      <td>0.117837</td>
      <td>0.739735</td>
    </tr>
    <tr>
      <th>6776195</th>
      <td>5</td>
      <td>1213510</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:1213510:C:T</td>
      <td>0.009318</td>
      <td>0.012922</td>
      <td>0.470845</td>
    </tr>
  </tbody>
</table>
<p>8463 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>keep   exact  flip   reverse  both   complement
False  False  False  False    False  False         118
True   False  True   False    False  False           1
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keep</th>
      <th>exact</th>
      <th>flip</th>
      <th>reverse</th>
      <th>both</th>
      <th>complement</th>
      <th>query</th>
      <th>subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811358</td>
      <td>811358</td>
    </tr>
    <tr>
      <th>14</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811368</td>
      <td>811368</td>
    </tr>
    <tr>
      <th>27</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811381</td>
      <td>811381</td>
    </tr>
    <tr>
      <th>41</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811395</td>
      <td>811395</td>
    </tr>
    <tr>
      <th>46</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811400</td>
      <td>811400</td>
    </tr>
    <tr>
      <th>50</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811402</td>
      <td>811402</td>
    </tr>
    <tr>
      <th>65</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811415</td>
      <td>811415</td>
    </tr>
    <tr>
      <th>74</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811422</td>
      <td>811422</td>
    </tr>
    <tr>
      <th>75</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811423</td>
      <td>811423</td>
    </tr>
    <tr>
      <th>83</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811431</td>
      <td>811431</td>
    </tr>
    <tr>
      <th>91</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>811439</td>
      <td>811439</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">both</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keep</th>
      <th>exact</th>
      <th>flip</th>
      <th>reverse</th>
      <th>both</th>
      <th>complement</th>
      <th>query</th>
      <th>subject</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">flip</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True     96
False    10
Name: flip, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">flip</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keep</th>
      <th>exact</th>
      <th>flip</th>
      <th>reverse</th>
      <th>both</th>
      <th>complement</th>
      <th>query</th>
      <th>subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811367</td>
      <td>811368</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>811368</td>
      <td>811367</td>
    </tr>
    <tr>
      <th>48</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>811400</td>
      <td>811401</td>
    </tr>
    <tr>
      <th>49</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811401</td>
      <td>811400</td>
    </tr>
    <tr>
      <th>65</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811414</td>
      <td>811415</td>
    </tr>
    <tr>
      <th>66</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>811415</td>
      <td>811414</td>
    </tr>
    <tr>
      <th>72</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811418</td>
      <td>811419</td>
    </tr>
    <tr>
      <th>73</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811419</td>
      <td>811418</td>
    </tr>
    <tr>
      <th>97</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811440</td>
      <td>811441</td>
    </tr>
    <tr>
      <th>98</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811441</td>
      <td>811440</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>811366</th>
      <td>5</td>
      <td>275982</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:275982:C:T</td>
      <td>-1.158610</td>
      <td>1.623030</td>
      <td>0.475317</td>
    </tr>
    <tr>
      <th>811367</th>
      <td>5</td>
      <td>275984</td>
      <td>A</td>
      <td>G</td>
      <td>chr5:275984:A:G</td>
      <td>-1.215220</td>
      <td>0.968170</td>
      <td>0.209418</td>
    </tr>
    <tr>
      <th>811368</th>
      <td>5</td>
      <td>275984</td>
      <td>A</td>
      <td>T</td>
      <td>chr5:275984:A:T</td>
      <td>-1.023460</td>
      <td>3.179240</td>
      <td>0.747513</td>
    </tr>
    <tr>
      <th>811369</th>
      <td>5</td>
      <td>275989</td>
      <td>T</td>
      <td>G</td>
      <td>chr5:275989:T:G</td>
      <td>-1.059680</td>
      <td>1.854150</td>
      <td>0.567647</td>
    </tr>
    <tr>
      <th>811370</th>
      <td>5</td>
      <td>275996</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:275996:C:T</td>
      <td>1.908060</td>
      <td>1.769520</td>
      <td>0.280905</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>811447</th>
      <td>5</td>
      <td>306692</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:306692:G:A</td>
      <td>0.974559</td>
      <td>0.321401</td>
      <td>0.005570</td>
    </tr>
    <tr>
      <th>811448</th>
      <td>5</td>
      <td>306695</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:306695:C:T</td>
      <td>-1.051520</td>
      <td>1.797830</td>
      <td>0.558627</td>
    </tr>
    <tr>
      <th>811449</th>
      <td>5</td>
      <td>306703</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:306703:C:T</td>
      <td>0.645902</td>
      <td>1.310650</td>
      <td>0.622147</td>
    </tr>
    <tr>
      <th>811450</th>
      <td>5</td>
      <td>306732</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:306732:C:T</td>
      <td>-1.033180</td>
      <td>3.113500</td>
      <td>0.740011</td>
    </tr>
    <tr>
      <th>811451</th>
      <td>5</td>
      <td>306748</td>
      <td>C</td>
      <td>T</td>
      <td>chr5:306748:C:T</td>
      <td>1.738350</td>
      <td>0.358186</td>
      <td>0.000012</td>
    </tr>
  </tbody>
</table>
<p>86 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">exact</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keep</th>
      <th>exact</th>
      <th>flip</th>
      <th>reverse</th>
      <th>both</th>
      <th>complement</th>
      <th>query</th>
      <th>subject</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>811401</td>
      <td>811367</td>
    </tr>
    <tr>
      <th>64</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>811415</td>
      <td>811400</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>91</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="n">tmp</span><span class="o">.</span><span class="n">subject</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0      False
1      False
2      False
3      False
4      False
       ...  
106    False
107    False
108    False
109    False
110    False
Name: subject, Length: 111, dtype: bool</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">811401</span><span class="p">,</span><span class="mi">811415</span><span class="p">],:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>811401</th>
      <td>5</td>
      <td>276395</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:276395:G:A</td>
      <td>-1.19077</td>
      <td>1.87388</td>
      <td>0.525130</td>
    </tr>
    <tr>
      <th>811415</th>
      <td>5</td>
      <td>276938</td>
      <td>C</td>
      <td>G</td>
      <td>chr5:276938:C:G</td>
      <td>-1.12324</td>
      <td>1.80101</td>
      <td>0.532845</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">811367</span><span class="p">,</span><span class="mi">811400</span><span class="p">],:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>811367</th>
      <td>5</td>
      <td>275984</td>
      <td>G</td>
      <td>A</td>
      <td>chr5:275984:A:G</td>
      <td>-1.215220</td>
      <td>0.968170</td>
      <td>0.209418</td>
    </tr>
    <tr>
      <th>811400</th>
      <td>5</td>
      <td>276395</td>
      <td>C</td>
      <td>G</td>
      <td>chr5:276395:G:C</td>
      <td>0.852057</td>
      <td>0.586238</td>
      <td>0.146104</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">exact</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False    109
True       2
Name: exact, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">POS</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>306584    2
276395    2
276938    2
275984    2
276973    2
         ..
276216    1
276215    1
276202    1
276191    1
306748    1
Name: POS, Length: 91, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1733</th>
      <td>1</td>
      <td>976512</td>
      <td>G</td>
      <td>A</td>
      <td>chr1:976512:G:A</td>
      <td>-1.043870</td>
      <td>3.130310</td>
      <td>0.738780</td>
    </tr>
    <tr>
      <th>6959</th>
      <td>1</td>
      <td>1333753</td>
      <td>G</td>
      <td>C</td>
      <td>chr1:1333753:G:C</td>
      <td>-1.048260</td>
      <td>2.806530</td>
      <td>0.708771</td>
    </tr>
    <tr>
      <th>9458</th>
      <td>1</td>
      <td>1495680</td>
      <td>T</td>
      <td>C</td>
      <td>chr1:1495680:T:C</td>
      <td>0.147934</td>
      <td>0.850903</td>
      <td>0.861979</td>
    </tr>
    <tr>
      <th>11995</th>
      <td>1</td>
      <td>1737811</td>
      <td>T</td>
      <td>C</td>
      <td>chr1:1737811:T:C</td>
      <td>-0.046021</td>
      <td>1.078830</td>
      <td>0.965974</td>
    </tr>
    <tr>
      <th>13127</th>
      <td>1</td>
      <td>1955424</td>
      <td>T</td>
      <td>C</td>
      <td>chr1:1955424:T:C</td>
      <td>0.140340</td>
      <td>0.104258</td>
      <td>0.178278</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2991282</th>
      <td>22</td>
      <td>37206803</td>
      <td>C</td>
      <td>T</td>
      <td>chr22:37206803:C:T</td>
      <td>2.635060</td>
      <td>1.949880</td>
      <td>0.176570</td>
    </tr>
    <tr>
      <th>2999438</th>
      <td>22</td>
      <td>39240918</td>
      <td>T</td>
      <td>TGCGC</td>
      <td>chr22:39240918:T:TGCGC</td>
      <td>1.020610</td>
      <td>1.452690</td>
      <td>0.482324</td>
    </tr>
    <tr>
      <th>3013185</th>
      <td>22</td>
      <td>44786566</td>
      <td>G</td>
      <td>A</td>
      <td>chr22:44786566:G:A</td>
      <td>0.580112</td>
      <td>0.696360</td>
      <td>0.404809</td>
    </tr>
    <tr>
      <th>3024911</th>
      <td>22</td>
      <td>50315712</td>
      <td>A</td>
      <td>G</td>
      <td>chr22:50315712:A:G</td>
      <td>-1.085230</td>
      <td>2.524020</td>
      <td>0.667223</td>
    </tr>
    <tr>
      <th>3028072</th>
      <td>22</td>
      <td>50603663</td>
      <td>G</td>
      <td>A</td>
      <td>chr22:50603663:G:A</td>
      <td>-1.089630</td>
      <td>2.563200</td>
      <td>0.670760</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smry</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
<span class="n">subject</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">210</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
<span class="n">qi</span><span class="p">,</span><span class="n">si</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="nb">next</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">multi_snps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span><span class="p">(</span><span class="n">qi</span> <span class="ow">and</span> <span class="n">si</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">qi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">si</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">multi_snps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="n">qi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">qi</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">multi_snps</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">smry</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">multi_snps</span><span class="p">:</span>
                <span class="n">smry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snp_match</span><span class="p">(</span><span class="n">qi</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">qi</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="p">[</span><span class="n">qi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">qi</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="n">si</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">si</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">multi_snps</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">qi</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">si</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">qi</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">multi_snps</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">smry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">multi_snps</span><span class="p">:</span>
                    <span class="n">smry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snp_match</span><span class="p">(</span><span class="n">qi</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">qi</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="p">[</span><span class="n">qi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#same pos has multiple snps</span>
            <span class="c1">#query compare with each of them in subject</span>
            <span class="n">multi_snps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
            <span class="n">smry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snp_match</span><span class="p">(</span><span class="n">qi</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">qi</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">si</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">si</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="p">[</span><span class="n">qi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="n">si</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">smry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">smry</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pandas(Index=1733, CHR=1, POS=976512, REF=&#39;G&#39;, ALT=&#39;A&#39;, SNP=&#39;chr1:976512:G:A&#39;, BETA=-1.04387, SE=3.13031, P=0.7387797791025819) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=6959, CHR=1, POS=1333753, REF=&#39;G&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1333753:G:C&#39;, BETA=-1.04826, SE=2.80653, P=0.7087710984181352) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=9458, CHR=1, POS=1495680, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1495680:T:C&#39;, BETA=0.147934, SE=0.850903, P=0.861979425862772) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=11995, CHR=1, POS=1737811, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1737811:T:C&#39;, BETA=-0.0460207, SE=1.07883, P=0.9659741397427256) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=13127, CHR=1, POS=1955424, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1955424:T:C&#39;, BETA=0.14034, SE=0.104258, P=0.178277690755054) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=14530, CHR=1, POS=2303171, REF=&#39;C&#39;, ALT=&#39;T&#39;, SNP=&#39;chr1:2303171:C:T&#39;, BETA=-1.05115, SE=2.34098, P=0.6534178585573059) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=15435, CHR=1, POS=2406725, REF=&#39;G&#39;, ALT=&#39;A&#39;, SNP=&#39;chr1:2406725:G:A&#39;, BETA=-1.11988, SE=1.3376, P=0.4024602568261106) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=31462, CHR=1, POS=10307349, REF=&#39;G&#39;, ALT=&#39;A&#39;, SNP=&#39;chr1:10307349:G:A&#39;, BETA=-1.10213, SE=1.49971, P=0.4624001858860571) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=33819, CHR=1, POS=11080678, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:11080678:T:C&#39;, BETA=-1.65391, SE=1.53434, P=0.2810657974090764) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
Pandas(Index=38760, CHR=1, POS=12348810, REF=&#39;C&#39;, ALT=&#39;T&#39;, SNP=&#39;chr1:12348810:C:T&#39;, BETA=2.45887, SE=1.90922, P=0.1977839290228308) Pandas(Index=301220, CHR=1, POS=242107640, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:242107640:T:C&#39;, BETA=0.331632, SE=0.441286, P=0.452343131230923)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smry</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False]),
 array([False, False, False, False, False])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ai</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ai</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">ai</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span><span class="n">tmp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pandas(Index=1733, CHR=1, POS=976512, REF=&#39;G&#39;, ALT=&#39;A&#39;, SNP=&#39;chr1:976512:G:A&#39;, BETA=-1.04387, SE=3.13031, P=0.7387797791025819)
tmp Pandas(Index=6959, CHR=1, POS=1333753, REF=&#39;G&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1333753:G:C&#39;, BETA=-1.04826, SE=2.80653, P=0.7087710984181352)
Pandas(Index=9458, CHR=1, POS=1495680, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1495680:T:C&#39;, BETA=0.147934, SE=0.850903, P=0.861979425862772)
tmp Pandas(Index=11995, CHR=1, POS=1737811, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1737811:T:C&#39;, BETA=-0.0460207, SE=1.07883, P=0.9659741397427256)
Pandas(Index=13127, CHR=1, POS=1955424, REF=&#39;T&#39;, ALT=&#39;C&#39;, SNP=&#39;chr1:1955424:T:C&#39;, BETA=0.14034, SE=0.104258, P=0.178277690755054)
tmp None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.SNPs-match-in-two-sumstats">3.SNPs match in two sumstats<a class="anchor-link" href="#3.SNPs-match-in-two-sumstats"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">snps_match</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">subject</span><span class="p">,</span><span class="n">keep_ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">query</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">subject</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">subject</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#overlap snps by chr+pos</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total rows of query: &quot;</span><span class="p">,</span><span class="n">query</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;Total rows of subject: &quot;</span><span class="p">,</span><span class="n">subject</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="n">subject</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subject</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Overlap chr:pos&quot;</span><span class="p">,</span><span class="n">query</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There are duplicated chr:pos&quot;</span><span class="p">)</span>
    <span class="n">pm</span> <span class="o">=</span> <span class="n">pair_match</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">ALT</span><span class="p">,</span><span class="n">query</span><span class="o">.</span><span class="n">REF</span><span class="p">,</span><span class="n">subject</span><span class="o">.</span><span class="n">ALT</span><span class="p">,</span><span class="n">subject</span><span class="o">.</span><span class="n">REF</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keep_ambiguous</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: there are&#39;</span><span class="p">,</span><span class="nb">sum</span><span class="p">(</span><span class="o">~</span><span class="n">pm</span><span class="o">.</span><span class="n">ambiguous</span><span class="p">),</span><span class="s1">&#39;ambiguous SNPs&#39;</span><span class="p">)</span>
        <span class="n">pm</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pm</span> <span class="o">=</span> <span class="n">pm</span><span class="p">[</span><span class="o">~</span><span class="n">pm</span><span class="o">.</span><span class="n">ambiguous</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">keep_idx</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Overlap SNPs&quot;</span><span class="p">,</span><span class="nb">sum</span><span class="p">(</span><span class="n">keep_idx</span><span class="p">))</span>
    <span class="c1">#overlap snps by chr+pos+alleles.</span>
    <span class="n">new_subject</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>
    <span class="c1">#update beta and snp info</span>
    <span class="n">new_query</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">new_subject</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">],</span><span class="n">query</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">:]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">new_query</span><span class="o">.</span><span class="n">BETA</span><span class="p">[</span><span class="n">pm</span><span class="o">.</span><span class="n">sign_flip</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">new_query</span><span class="o">.</span><span class="n">BETA</span><span class="p">[</span><span class="n">pm</span><span class="o">.</span><span class="n">sign_flip</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">new_query</span><span class="p">,</span><span class="n">new_subject</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pair_match</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">ref1</span><span class="p">,</span><span class="n">ref2</span><span class="p">):</span>
    <span class="c1"># a1 and a2 are the first data-set</span>
	<span class="c1"># ref1 and ref2 are the 2nd data-set</span>
	<span class="c1"># Make all the alleles into upper-case, as A,T,C,G:</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">a1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">a2</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ref1</span> <span class="o">=</span> <span class="n">ref1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ref2</span> <span class="o">=</span> <span class="n">ref2</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
	<span class="c1"># Strand flip, to change the allele representation in the 2nd data-set</span>
    <span class="n">flip1</span> <span class="o">=</span> <span class="n">ref1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">strand_flip</span><span class="p">)</span>
    <span class="n">flip2</span> <span class="o">=</span> <span class="n">ref2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">strand_flip</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;ambiguous&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="s2">&quot;T&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="s2">&quot;T&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="s2">&quot;G&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="s2">&quot;G&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
    <span class="c1"># as long as scenario 1 is involved, sign_flip will return TRUE</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;sign_flip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="n">ref2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="n">ref1</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="n">flip2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="n">flip1</span><span class="p">))</span>
	<span class="c1"># as long as scenario 2 is involved, strand_flip will return TRUE</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;strand_flip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="n">flip1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="n">flip2</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">a1</span><span class="o">==</span><span class="n">flip2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span><span class="o">==</span><span class="n">flip1</span><span class="p">))</span>
	<span class="c1"># remove other cases, eg, tri-allelic, one dataset is A C, the other is A G, for example.</span>
    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;exact_match&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">a1</span> <span class="o">==</span> <span class="n">ref1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a2</span> <span class="o">==</span> <span class="n">ref2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">strand_flip</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.Create-testing-MWE">4.Create testing MWE<a class="anchor-link" href="#4.Create-testing-MWE"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exome_sumstats</span> <span class="o">=</span> <span class="n">Sumstat</span><span class="p">(</span><span class="n">sumstats_path</span><span class="p">)</span>
<span class="c1">#exome_sumstats.extractbyregion(region)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">exome_sumstats</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CHR</th>
      <th>POS</th>
      <th>REF</th>
      <th>ALT</th>
      <th>SNP</th>
      <th>BETA</th>
      <th>SE</th>
      <th>P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>709</th>
      <td>1</td>
      <td>953305</td>
      <td>G</td>
      <td>A</td>
      <td>chr1:953305:G:A</td>
      <td>-0.137062</td>
      <td>0.731144</td>
      <td>0.851298</td>
    </tr>
    <tr>
      <th>2118</th>
      <td>1</td>
      <td>1014359</td>
      <td>G</td>
      <td>T</td>
      <td>chr1:1014359:G:T</td>
      <td>-1.110110</td>
      <td>1.724070</td>
      <td>0.519648</td>
    </tr>
    <tr>
      <th>4067</th>
      <td>1</td>
      <td>1211543</td>
      <td>G</td>
      <td>T</td>
      <td>chr1:1211543:G:T</td>
      <td>-0.220586</td>
      <td>0.947774</td>
      <td>0.815963</td>
    </tr>
    <tr>
      <th>7641</th>
      <td>1</td>
      <td>1355779</td>
      <td>GA</td>
      <td>G</td>
      <td>chr1:1355779:GA:G</td>
      <td>0.096933</td>
      <td>0.488808</td>
      <td>0.842807</td>
    </tr>
    <tr>
      <th>13114</th>
      <td>1</td>
      <td>1955369</td>
      <td>C</td>
      <td>G</td>
      <td>chr1:1955369:C:G</td>
      <td>-0.066739</td>
      <td>0.762243</td>
      <td>0.930230</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3022270</th>
      <td>22</td>
      <td>50210362</td>
      <td>C</td>
      <td>T</td>
      <td>chr22:50210362:C:T</td>
      <td>-1.147250</td>
      <td>1.521600</td>
      <td>0.450867</td>
    </tr>
    <tr>
      <th>3023900</th>
      <td>22</td>
      <td>50278367</td>
      <td>C</td>
      <td>T</td>
      <td>chr22:50278367:C:T</td>
      <td>-1.222950</td>
      <td>1.248900</td>
      <td>0.327472</td>
    </tr>
    <tr>
      <th>3025632</th>
      <td>22</td>
      <td>50455242</td>
      <td>G</td>
      <td>A</td>
      <td>chr22:50455242:G:A</td>
      <td>0.634902</td>
      <td>0.433051</td>
      <td>0.142618</td>
    </tr>
    <tr>
      <th>3026405</th>
      <td>22</td>
      <td>50488346</td>
      <td>A</td>
      <td>G</td>
      <td>chr22:50488346:A:G</td>
      <td>-0.564272</td>
      <td>0.900978</td>
      <td>0.531125</td>
    </tr>
    <tr>
      <th>3026963</th>
      <td>22</td>
      <td>50517779</td>
      <td>C</td>
      <td>T</td>
      <td>chr22:50517779:C:T</td>
      <td>0.989030</td>
      <td>0.882422</td>
      <td>0.262367</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 8 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">520</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss1</span> <span class="o">=</span> <span class="n">ss1</span><span class="p">[</span><span class="o">~</span><span class="n">ss1</span><span class="o">.</span><span class="n">POS</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">reverse_refalt</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">REF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">REF</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">ALT</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">ALT</span> <span class="o">=</span> <span class="n">ref</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">BETA</span> <span class="o">=</span> <span class="o">-</span><span class="n">ss</span><span class="o">.</span><span class="n">BETA</span>
    <span class="k">return</span> <span class="n">ss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">flip_snps</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">REF</span> <span class="o">=</span> <span class="p">[</span><span class="n">strand_flip</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ss</span><span class="o">.</span><span class="n">REF</span><span class="p">]</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">ALT</span> <span class="o">=</span> <span class="p">[</span><span class="n">strand_flip</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ss</span><span class="o">.</span><span class="n">ALT</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">snps_match</span><span class="p">(</span><span class="n">flip_snps</span><span class="p">(</span><span class="n">ss1</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">keep_ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total rows of query:  500 Total rows of subject:  1000
Overlap chr:pos 500
Warning: there are 418 ambiguous SNPs
Overlap SNPs 500
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/1988675.1.plot.q/ipykernel_30609/2132708780.py:23: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  new_query.BETA[pm.sign_flip] = -new_query.BETA[pm.sign_flip]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(              CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850   1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns],
               CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850  -1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">snps_match</span><span class="p">(</span><span class="n">reverse_refalt</span><span class="p">(</span><span class="n">ss1</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total rows of query:  500 Total rows of subject:  1000
Overlap chr:pos 500
Warning: there are 418 ambiguous SNPs
Overlap SNPs 500
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/1988675.1.plot.q/ipykernel_30609/2132708780.py:23: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  new_query.BETA[pm.sign_flip] = -new_query.BETA[pm.sign_flip]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(              CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850  -1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns],
               CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850  -1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">snps_match</span><span class="p">(</span><span class="n">flip_snps</span><span class="p">(</span><span class="n">reverse_refalt</span><span class="p">(</span><span class="n">ss1</span><span class="p">)),</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total rows of query:  500 Total rows of subject:  1000
Overlap chr:pos 500
Warning: there are 418 ambiguous SNPs
Overlap SNPs 500
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/1988675.1.plot.q/ipykernel_30609/2132708780.py:23: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  new_query.BETA[pm.sign_flip] = -new_query.BETA[pm.sign_flip]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(              CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850  -1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns],
               CHR        POS         REF ALT                         SNP  \
 1:18744859      1   18744859           G   A           chr1:18744859:G:A   
 1:19112524      1   19112524           C   T           chr1:19112524:C:T   
 1:19112744      1   19112744           C   T           chr1:19112744:C:T   
 1:19220870      1   19220870  TTCACACCGA   T  chr1:19220870:TTCACACCGA:T   
 1:19324561      1   19324561           G   A           chr1:19324561:G:A   
 ...           ...        ...         ...  ..                         ...   
 10:93074445    10   93074445           G   A          chr10:93074445:G:A   
 10:94171346    10   94171346           C   T          chr10:94171346:C:T   
 10:97370850    10   97370850           A   T          chr10:97370850:A:T   
 10:100293231   10  100293231           A   G         chr10:100293231:A:G   
 10:101803994   10  101803994           A   G         chr10:101803994:A:G   
 
                   BETA        SE         P  
 1:18744859   -1.280560  1.327880  0.334864  
 1:19112524   -1.063210  2.760900  0.700168  
 1:19112744   -0.475555  0.539997  0.378501  
 1:19220870   -1.101250  2.434530  0.651020  
 1:19324561    0.908711  1.011330  0.368904  
 ...                ...       ...       ...  
 10:93074445  -1.282030  0.989365  0.195040  
 10:94171346  -1.054960  2.390500  0.658984  
 10:97370850  -1.069910  2.301690  0.642049  
 10:100293231  0.511226  1.280380  0.689689  
 10:101803994 -1.083250  2.012430  0.590386  
 
 [500 rows x 8 columns])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.1-Write-out-test-examples">4.1 Write out test examples<a class="anchor-link" href="#4.1-Write-out-test-examples"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/testflip/snps1000.regenie.snp_stats.gz&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHR&#39;</span><span class="p">,</span><span class="s1">&#39;POS&#39;</span><span class="p">,</span><span class="s1">&#39;REF&#39;</span><span class="p">,</span><span class="s1">&#39;ALT&#39;</span><span class="p">,</span><span class="s1">&#39;SNP&#39;</span><span class="p">,</span><span class="s1">&#39;BETA&#39;</span><span class="p">,</span><span class="s1">&#39;SE&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">]</span>
<span class="n">ss1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/testflip/snps500.regenie.snp_stats.gz&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fss1</span> <span class="o">=</span> <span class="n">flip_snps</span><span class="p">(</span><span class="n">ss1</span><span class="p">)</span>
<span class="n">fss1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHR&#39;</span><span class="p">,</span><span class="s1">&#39;POS&#39;</span><span class="p">,</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;SNP&#39;</span><span class="p">,</span><span class="s1">&#39;STAT&#39;</span><span class="p">,</span><span class="s1">&#39;SE&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">]</span>
<span class="n">fss1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/testflip/flip/snps500_flip.regenie.snp_stats.gz&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reverse_refalt</span><span class="p">(</span><span class="n">ss1</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/testflip/snps500_rea0a1.regenie.snp_stats.gz&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flip_snps</span><span class="p">(</span><span class="n">reverse_refalt</span><span class="p">(</span><span class="n">ss1</span><span class="p">))</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/testflip/snps500_flip_rea0a1.regenie.snp_stats.gz&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

