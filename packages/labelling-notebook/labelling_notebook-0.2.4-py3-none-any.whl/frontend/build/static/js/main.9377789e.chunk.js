(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{188:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(26),o=t.n(i),c=t(81),l=t(6),u=t(23),d=t(7),s=t(5),h=t(9),g=t(8),f=(t(59),t(102),t(73)),b=t.n(f),m=t(48),v=t.n(m),p=t(75),x=t(52),E=t(49),w=t.n(E),y=function(){return fetch.apply(void 0,arguments).then((function(e){return e.ok?e.json():null}))},O=new w.a({lightness:.5,saturation:.7,hue:220}).hex(""),j=new w.a({lightness:.5,saturation:1,hue:200}).hex("");var k,S=t(35);function z(e){var n=Object(x.a)("/api/files",y).data,t=n||[];return r.a.createElement(X,null,r.a.createElement(b.a,{files:t,filterRenderer:function(){return r.a.createElement("div",null)},detailRenderer:function(){return r.a.createElement("div",null)},icons:{Image:r.a.createElement(S.c,null),Folder:r.a.createElement(S.a,null),FolderOpen:r.a.createElement(S.b,null)},onSelect:function(n){if(console.log(n),n)return e.onSelectImage?e.onSelectImage(n.key):null}}))}var R,A,L,C,M,P,T,D,J,X=g.a.div(k||(k=Object(d.a)(["\n    padding: 0;\n    overflow-y: scroll;\n    \n    div.rendered-react-keyed-file-browser {\n        .action-bar { \n            display: none;\n        }\n    \n        .files {\n            .name svg {\n                margin-right: 0.3em;\n                margin-top:-0.2em;\n            }\n            \n            \n            table tr td:last-child,\n            table tr th:last-child {\n                display: none;\n            }\n            \n            table tr:not(:last-child) td,\n            table tr {\n                border: none;\n                td { border: none; }\n                th { border: none; }\n            }\n        }\n    }\n"]))),F=function(e){var n=e.leftPane,t=e.rightPane,i=e.className,o=e.componentsSize,c=e.onComponentsResize,l=e.children,u=Object(a.createRef)(),d=Object(a.useState)(null),g=Object(h.a)(d,2),f=g[0],b=g[1],m=o.left.width,v=o.right.width,p=function(e){if(f&&u.current){var n=m,t=v;"leftPane"==f.resizingTarget&&(n=m+e-f.xPosition),"rightPane"==f.resizingTarget&&(t=v-e+f.xPosition),x(n,t),b(Object(s.a)(Object(s.a)({},f),{},{xPosition:e}))}},x=function(e,n){if(u.current){var t=u.current.clientHeight,a=u.current.clientWidth;c&&c({left:{height:t,width:e},center:{height:t,width:a-n-e},right:{height:t,width:n}})}},E=function(e){e.preventDefault(),p(e.clientX)},w=function(e){p(e.touches[0].clientX)},y=function(){b(null)};return r.a.useEffect((function(){return document.addEventListener("mousemove",E),document.addEventListener("touchmove",w),document.addEventListener("mouseup",y),function(){document.removeEventListener("mousemove",E),document.removeEventListener("touchmove",w),document.removeEventListener("mouseup",y)}})),Object(a.useLayoutEffect)((function(){if(u.current){var e=function(){return window.requestAnimationFrame((function(){return x(m,v)}))};return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),function(){window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}}),[u]),r.a.createElement(q,{className:"".concat(null!==i&&void 0!==i?i:""),ref:u},r.a.createElement(I,{width:m,setWidth:function(e){return x(e,v)}},n),r.a.createElement(N,{onDraggingStart:function(e){return b({xPosition:e,resizingTarget:"leftPane"})},onDraggingEnd:function(){return b(null)}}),r.a.createElement(U,null,l),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{onDraggingStart:function(e){return b({xPosition:e,resizingTarget:"rightPane"})},onDraggingEnd:function(){return b(null)}}),r.a.createElement(I,{width:v,setWidth:function(e){return x(m,e)}},t)))},N=function(e){var n=e.onDraggingStart,t=e.onDraggingEnd;return r.a.createElement(W,{onMouseDown:function(e){return n(e.clientX)},onTouchStart:function(e){return n(e.touches[0].clientX)},onTouchEnd:t},r.a.createElement(Y,null))},I=function(e){var n=e.children,t=e.width,i=e.setWidth,o=Object(a.createRef)();return Object(a.useEffect)((function(){if(o.current){if(!t)return void i(o.current.clientWidth);o.current.style.width="".concat(t,"px")}}),[o,t,i]),r.a.createElement(B,{ref:o},n)},W=g.a.div(R||(R=Object(d.a)(["\n  cursor: col-resize;\n  align-self: stretch;\n  display: flex;\n  align-items: center;\n"]))),Y=g.a.div(A||(A=Object(d.a)(["\n  height: 100%;\n  border: 1px solid #ddd;\n"]))),B=g.a.div(L||(L=Object(d.a)(["\n  overflow: hidden;\n  height: 100%;\n"]))),U=g.a.div(C||(C=Object(d.a)(["\n  flex: 1;\n  height: 100%;\n  overflow-x: hidden;\n"]))),q=g.a.div(M||(M=Object(d.a)([" {\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n"]))),H=t(78),_=t.n(H),G=t(79),K=t.n(G),Q=(t(160),t(161),t(83)),V=t(192);function Z(e){var n=e.image,t=e.tags,i=e.annotations,o=e.selectedAnnotation,c=e.onSelectAnnotation,l=void 0===c?function(){return null}:c,u=e.onChangeTags,d=void 0===u?function(){return null}:u,g=e.onChangeAnnotations,f=void 0===g?function(){return null}:g,b=function(e,n){var t=Object(a.useMemo)((function(){return e.map((function(e){return{value:e,label:e}}))}),[e]);return[t,function(e){if(n){var t=e.map((function(e){return e.value}));n(t)}}]}(t,d),m=Object(h.a)(b,2),v=m[0],p=m[1],x=function(e,n){var t=Object(a.useMemo)((function(){return e.map((function(e){var n=Object(s.a)({},e),t='{\n  "x":'.concat(e.x,', "y":').concat(e.y,', "width":').concat(e.width,', "height":').concat(e.height,",\n");return delete n.x,delete n.y,delete n.width,delete n.height,{value:JSON.stringify(n,null,2).replace("{",t).replace("\n\n","\n"),isJson:!0}}))}),[e]),i=Object(a.useState)(t),o=Object(h.a)(i,2),c=o[0],l=o[1];r.a.useEffect((function(){l(t)}),[t]);return[c,function(e,n){c[e].value=n,c[e].isJson=function(e){try{JSON.parse(e)}catch(n){return!1}return!0}(n),l(c)},function(e){c[e]=t[e],l(c)},function(t){var a=JSON.parse(c[t].value);if(a&&n){var r=e.slice();r[t]=a,n(r)}}]}(i,f),E=Object(h.a)(x,4),w=E[0],y=E[1],k=E[2],S=E[3],z=function(e){return l(void 0)};return r.a.createElement(ee,null,n&&r.a.createElement(ne,null,r.a.createElement("h4",null,n.key),r.a.createElement("p",null,n.width," x ",n.height)),r.a.createElement(te,null,r.a.createElement("h5",null,"Tags:"),r.a.createElement(Q.a,{isMulti:!0,value:v,onChange:function(e){return p(e)},formatCreateLabel:function(e){return'Add tag "'.concat(e,'"')}})),r.a.createElement(te,null,r.a.createElement("h5",null,"Annotations:"),i.map((function(e,n){var t=o===n,a=e.color||(t?j:O),i=e.label||"at (x=".concat(e.x,", y=").concat(e.y,")");return r.a.createElement(_.a,{key:n,trigger:r.a.createElement("div",null,r.a.createElement(ae,{style:{backgroundColor:a}}),r.a.createElement("span",null,"Annotation: ",r.a.createElement("i",null,i))),transitionTime:100,openedClassName:"open",open:o===n,onOpening:function(){return function(e){return l(e)}(n)},onClosing:function(){z(),k(n)}},w[n]&&r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{value:w[n].value,mode:"json",theme:"github",width:"100%",height:"".concat(20*w[n].value.split("\n").length,"px"),onChange:function(e){return y(n,e)}}),r.a.createElement(V.a,{size:"sm",variant:"primary",disabled:!w[n].isJson,onClick:function(){z(),S(n)}},"Save")))}))))}var $,ee=g.a.div(P||(P=Object(d.a)(["\n    position: relative;\n    overflow-x: hidden;\n    height: 100%;\n    width: 100%;\n    \n    .Collapsible {\n    \n        padding: 0px;\n        \n        &:hover {\n            background: #eee;\n        }\n        \n        &.open {\n            background: #e8e8e8;\n        }\n        \n        >span {\n            width: 100%;\n            display: block;\n            margin-bottom: 5px;\n            padding: 8px 8px;\n        }\n        \n        >div {\n            padding: 0px 8px;\n        }\n        \n        button {\n            float: right;\n            margin: 8px 0px;\n        }\n    }\n"]))),ne=g.a.div(T||(T=Object(d.a)(["\n    padding: 20px 10px;\n    margin-bottom: 30px;\n    \n    color: rgba(200,200,200, 1);\n    background-color: rgba(17,24,39, 1);\n"]))),te=g.a.div(D||(D=Object(d.a)(["\n    padding: 10px;\n    margin-bottom: 20px;\n    color: rgba(17,24,39, 1);\n"]))),ae=g.a.span(J||(J=Object(d.a)(["\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    display: inline-block;\n    margin-right: 5px;\n    top: 3px;\n    position: relative;\n"]))),re=t(21);function ie(e,n){var t=n.x,a=n.y,r=n.width,i=n.height,o=e.scale,c=e.offset;return Object(s.a)(Object(s.a)({},n),{},{x:o*t+c.x,y:o*a+c.y,width:o*r,height:o*i})}function oe(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=n.x,r=n.y,i=n.width,o=n.height,c=e.scale,l=e.offset,u={x:(a-l.x)/c,y:(r-l.y)/c,width:i/c,height:o/c};return t?Object(s.a)(Object(s.a)({},n),{},{x:Math.round(u.x),y:Math.round(u.y),width:Math.round(u.width),height:Math.round(u.height)}):u}function ce(e){var n=e.rect,t=e.color,a=e.isSelected,i=e.onSelect,o=void 0===i?function(){return null}:i,c=e.onRectChange,l=void 0===c?function(){return null}:c,u=r.a.useRef(),d=r.a.useRef();return r.a.useEffect((function(){a&&(d.current.nodes([u.current]),d.current.getLayer().batchDraw())}),[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(re.c,Object.assign({fill:t,opacity:.5,onClick:o,onTap:o,ref:u},n,{draggable:a,onDragEnd:function(e){l(Object(s.a)(Object(s.a)({},n),{},{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var t=u.current,a=t.scaleX(),r=t.scaleY();t.scaleX(1),t.scaleY(1),l(Object(s.a)(Object(s.a)({},n),{},{x:t.x(),y:t.y(),width:Math.max(5,t.width()*a),height:Math.max(t.height()*r)}))}})),a&&r.a.createElement(re.e,{ref:d,rotateEnabled:!1,boundBoxFunc:function(e,n){return n.width<5||n.height<5?e:n}}))}function le(e){var n=e.image,t=e.width,a=e.height,i=e.annotations,o=e.onChangeAnnotations,c=e.selectedAnnotation,l=e.onSelectAnnotation||function(e){},u=r.a.useState(null),d=Object(h.a)(u,2),g=d[0],f=d[1],b=r.a.useState(null),m=Object(h.a)(b,2),v=m[0],p=m[1];if(!n.element)return r.a.createElement(fe,null);var x={width:t,height:a},E=function(e,n){var t=e.width/n.width,a=n.height*t;return a<=e.height?{offset:{x:0,y:(e.height-a)/2},scale:t}:(t=e.height/n.height,{offset:{x:(e.width-n.width*t)/2,y:0},scale:t})}(x,n);return r.a.createElement(fe,null,r.a.createElement(re.d,Object.assign({},x,{onMouseDown:function(e){(e.target===e.target.getStage()||e.target.image)&&(c&&c>=0?l(void 0):(f({x:e.evt.layerX,y:e.evt.layerY}),p({x:e.evt.layerX,y:e.evt.layerY})))},onMouseUp:function(e){if(g){f(null),p(null);var n=be(g,v);if(n.width<10||n.height<10)return;var t=i.slice();t.push(oe(E,n)),o&&o(t),l(t.length-1)}},onMouseMove:function(e){g&&p({x:e.evt.layerX,y:e.evt.layerY})}}),r.a.createElement(re.b,null,r.a.createElement(re.a,Object.assign({image:n.element},ie(E,Object(s.a)({x:0,y:0},n)))),i.map((function(e,n){var t=c===n,a=e.color||(t?j:O);return r.a.createElement(ce,{key:n,color:a,rect:ie(E,e),isSelected:n===c,onSelect:function(){return l(n)},onRectChange:function(e){var t=i.slice();t[n]=oe(E,e),o&&o(t)}})})),g&&v&&r.a.createElement(re.c,Object.assign({},be(g,v),{fill:"rgba(1, 1,1,0.5)"})))))}var ue,de,se,he,ge,fe=g.a.div($||($=Object(d.a)(["\n    position: relative;\n    overflow-x: hidden;\n    height: 100%;\n    width: 100%;\n    background-color:#eee;\n"])));function be(e,n){var t=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y);return{x:t,y:r,width:a-t,height:Math.max(e.y,n.y)-r}}function me(){var e=Object(u.d)("key",u.c),n=Object(h.a)(e,2),t=n[0],i=n[1],o=Object(u.d)("index",u.a),c=Object(h.a)(o,2),l=c[0],d=c[1],g=function(e){var n=e?"/api/files/image/"+e:null,t=r.a.useState(null),a=Object(h.a)(t,2),i=a[0],o=a[1];return r.a.useEffect((function(){if(n){var t=document.createElement("img");return t.addEventListener("load",a),t.addEventListener("error",r),t.src=n,function(){t.removeEventListener("load",a),t.removeEventListener("error",r),o(null)}}function a(){o({key:e||"",element:t,width:t.width,height:t.height})}function r(){o(null)}}),[n]),[i]}(t),f=Object(h.a)(g,1)[0],b=function(e){var n=e?"/api/files/image_data/"+e:"",t=Object(x.a)(n,y),a=t.data,r=t.mutate;return[a,function(){var e=Object(p.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"PUT",body:JSON.stringify(t)});case 2:a=e.sent,r(Object(s.a)(Object(s.a)({},t),a));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()]}(t),m=Object(h.a)(b,2),E=m[0],w=m[1],O=(null===E||void 0===E?void 0:E.annotations)||[],j=function(e){w(Object(s.a)(Object(s.a)({},E),{},{annotations:e}))},k=function(e){if(null!==l&&void 0!==l){var n=O.slice();n[l]=Object(s.a)(Object(s.a)({},n[l]),e),j(n)}},S=(null===E||void 0===E?void 0:E.tags)||[],R=Object(a.useState)({left:{width:350,height:-1},right:{width:450,height:-1},center:{width:100,height:-1}}),A=Object(h.a)(R,2),L=A[0],C=A[1],M=function(e){if(e.target===document.body){if("Escape"===e.key&&d(void 0),"Backspace"===e.key&&(null!=l&&(O.splice(l,1),j(O)),d(void 0)),"ArrowDown"===e.key&&null!=l){var n=O[l];k({y:n.y+1})}if("ArrowUp"===e.key&&null!=l){var t=O[l];k({y:t.y-1})}if("ArrowLeft"===e.key&&null!=l){var a=O[l];k({x:a.x-1})}if("ArrowRight"===e.key&&null!=l){var r=O[l];k({x:r.x-1})}}};return Object(a.useEffect)((function(){return window.addEventListener("keydown",M),function(){window.removeEventListener("keydown",M)}})),r.a.createElement(ve,null,r.a.createElement(F,{componentsSize:L,onComponentsResize:function(e){C(e)},leftPane:r.a.createElement(xe,null,r.a.createElement(z,{onSelectImage:function(e){i(e),d(null)}})),rightPane:f&&r.a.createElement(Z,{image:f,tags:S,onChangeTags:function(e){w(Object(s.a)(Object(s.a)({},E),{},{tags:e}))},annotations:O,selectedAnnotation:l,onSelectAnnotation:d,onChangeAnnotations:j})},f&&f.element&&r.a.createElement(pe,null,r.a.createElement(le,{width:L.center.width,height:L.center.height,image:f,annotations:O,selectedAnnotation:l,onSelectAnnotation:d,onChangeAnnotations:j}))))}var ve=g.a.div(ue||(ue=Object(d.a)(["\n    height: 100vh;\n    \n    .Resizer {\n      background: #000;\n      opacity: 0.2;\n      z-index: 1;\n      -moz-box-sizing: border-box;\n      -webkit-box-sizing: border-box;\n      box-sizing: border-box;\n      -moz-background-clip: padding;\n      -webkit-background-clip: padding;\n      background-clip: padding-box;\n    }\n      \n    .Resizer:hover {\n      -webkit-transition: all 2s ease;\n      transition: all 2s ease;\n    }\n    \n    .Resizer.horizontal {\n      height: 11px;\n      margin: -5px 0;\n      border-top: 5px solid rgba(255, 255, 255, 0);\n      border-bottom: 5px solid rgba(255, 255, 255, 0);\n      cursor: row-resize;\n      width: 100%;\n    }\n    \n    .Resizer.horizontal:hover {\n      border-top: 5px solid rgba(0, 0, 0, 0.5);\n      border-bottom: 5px solid rgba(0, 0, 0, 0.5);\n    }\n    \n    .Resizer.vertical {\n      width: 11px;\n      margin: 0 -5px;\n      border-left: 5px solid rgba(255, 255, 255, 0);\n      border-right: 5px solid rgba(255, 255, 255, 0);\n      cursor: col-resize;\n    }\n    \n    .Resizer.vertical:hover {\n      border-left: 5px solid rgba(0, 0, 0, 0.5);\n      border-right: 5px solid rgba(0, 0, 0, 0.5);\n    }\n    .Resizer.disabled {\n      cursor: not-allowed;\n    }\n    .Resizer.disabled:hover {\n      border-color: transparent;\n    }\n"]))),pe=(g.a.div(de||(de=Object(d.a)(["\n    height: 100%;\n"]))),g.a.div(se||(se=Object(d.a)(["\n    height: 100%;\n"])))),xe=(g.a.div(he||(he=Object(d.a)(["\n    height: 100%;\n"]))),g.a.div(ge||(ge=Object(d.a)(["\n    height: 100%;\n    overflow: scroll;\n    background-color: rgba(17,24,39, 1);\n    color: rgba(156,163,175, 1);\n    \n    .files {\n        tbody {\n            tr, tr a {\n                color: rgba(156,163,175, 1);\n            }\n            \n            tr:hover {\n                background-color: rgba(255, 255, 255, 0.05);\n            }\n            \n            tr.selected, tr.selected a {\n                rgba(229,231,235,1);\n                background-color: rgba(55,65,81,1);\n            }\n        }\n    }\n"]))));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,null,r.a.createElement(u.b,{ReactRouterRoute:l.a},r.a.createElement(me,null)))),document.getElementById("root"))},87:function(e,n,t){e.exports=t(188)}},[[87,1,2]]]);
//# sourceMappingURL=main.9377789e.chunk.js.map