{"version":3,"file":"js/module_users.favorites.7b489f50.bundle.js","mappings":"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","sources":["webpack:///indico/modules/users/client/js/Favorites.module.scss?2fc1","webpack:///indico/modules/users/client/js/Favorites.jsx","webpack:///node_modules/lodash/orderBy.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"submit-button\":\"users-client-js-___Favorites-module__submit-button___AeA4z\",\"fav-list\":\"users-client-js-___Favorites-module__fav-list___KFdnj\",\"fav-item\":\"users-client-js-___Favorites-module__fav-item___FxbQW\",\"list-flex\":\"users-client-js-___Favorites-module__list-flex___Pvha0\",\"detail\":\"users-client-js-___Favorites-module__detail___IlIkm\",\"delete-button\":\"users-client-js-___Favorites-module__delete-button___wFq64\",\"empty-favorites\":\"users-client-js-___Favorites-module__empty-favorites___7j0mT\",\"fav-loader\":\"users-client-js-___Favorites-module__fav-loader___9Opw1\"};","// This file is part of Indico.\n// Copyright (C) 2002 - 2022 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport categoryFavoriteURL from 'indico-url:users.user_favorites_category_api';\n\nimport _ from 'lodash';\nimport PropTypes from 'prop-types';\nimport React, {useEffect, useState, useCallback} from 'react';\nimport ReactDOM from 'react-dom';\nimport {Button, Icon, List, Loader, Popup} from 'semantic-ui-react';\n\nimport {TooltipIfTruncated} from 'indico/react/components';\nimport {UserSearch} from 'indico/react/components/principals/Search';\nimport {useFavoriteUsers} from 'indico/react/hooks';\nimport {Translate} from 'indico/react/i18n';\nimport {indicoAxios, handleAxiosError} from 'indico/utils/axios';\n\nimport './Favorites.module.scss';\n\nwindow.setupFavoriteSelection = function setupFavoriteSelection(userId) {\n  ReactDOM.render(<FavoriteManager userId={userId} />, document.getElementById('user-favorites'));\n};\n\nfunction FavoriteManager({userId}) {\n  return (\n    <>\n      <FavoriteUserManager userId={userId} />\n      <FavoriteCatManager userId={userId} />\n    </>\n  );\n}\n\nFavoriteManager.propTypes = {\n  userId: PropTypes.number,\n};\n\nFavoriteManager.defaultProps = {\n  userId: null,\n};\n\nfunction FavoriteCatManager({userId}) {\n  const [favoriteCats, setFavoriteCats] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  const getFavoriteCats = useCallback(async () => {\n    let res;\n    try {\n      res = await indicoAxios.get(categoryFavoriteURL(userId !== null ? {user_id: userId} : {}));\n    } catch (error) {\n      handleAxiosError(error);\n      return;\n    }\n    setFavoriteCats(res.data);\n    setLoading(false);\n  }, [userId]);\n\n  useEffect(() => {\n    getFavoriteCats();\n  }, [getFavoriteCats]);\n\n  const deleteFavoriteCat = async id => {\n    try {\n      await indicoAxios.delete(categoryFavoriteURL({category_id: id}));\n    } catch (error) {\n      handleAxiosError(error);\n      return;\n    }\n    setFavoriteCats(values => _.omit(values, id));\n  };\n  return (\n    <div className=\"column col-50\">\n      <div className=\"i-box just-group-list\">\n        <div className=\"i-box-header\">\n          <div className=\"i-box-title\">\n            <Translate>Favorite Categories</Translate>\n          </div>\n        </div>\n        <div className=\"i-box-content\">\n          {loading ? (\n            <Loader active inline styleName=\"fav-loader\" />\n          ) : favoriteCats !== null && Object.keys(favoriteCats).length > 0 ? (\n            <List celled styleName=\"fav-list\">\n              {Object.values(favoriteCats).map(cat => (\n                <List.Item key={cat.id} styleName=\"fav-item\">\n                  <List.Content>\n                    <div styleName=\"list-flex\">\n                      <div>\n                        <a href={cat.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                          {cat.title}\n                        </a>\n                        <br />\n                        <TooltipIfTruncated>\n                          <span styleName=\"detail\">\n                            {cat.chain_titles.slice(0, -1).join(' Â» ')}\n                          </span>\n                        </TooltipIfTruncated>\n                      </div>\n                      <Popup\n                        trigger={\n                          <Icon\n                            styleName=\"delete-button\"\n                            name=\"close\"\n                            onClick={() => deleteFavoriteCat(cat.id)}\n                            link\n                          />\n                        }\n                        content={Translate.string('Remove from favorites')}\n                        position=\"bottom center\"\n                      />\n                    </div>\n                  </List.Content>\n                </List.Item>\n              ))}\n            </List>\n          ) : (\n            <div styleName=\"empty-favorites\">\n              <Translate>You have not marked any category as favorite.</Translate>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nFavoriteCatManager.propTypes = {\n  userId: PropTypes.number,\n};\n\nFavoriteCatManager.defaultProps = {\n  userId: null,\n};\n\nfunction FavoriteUserManager({userId}) {\n  const [favoriteUsers, [addFavoriteUser, deleteFavoriteUser], loading] = useFavoriteUsers(userId);\n\n  const searchTrigger = triggerProps => (\n    <Button {...triggerProps} styleName=\"submit-button\">\n      <Translate>Add Indico user</Translate>\n    </Button>\n  );\n  return (\n    <div className=\"column col-50\">\n      <div className=\"i-box just-group-list\">\n        <div className=\"i-box-header\">\n          <div className=\"i-box-title\">\n            <Translate>Favorite Users</Translate>\n          </div>\n        </div>\n        <div className=\"i-box-content\">\n          {loading ? (\n            <Loader active inline styleName=\"fav-loader\" />\n          ) : favoriteUsers !== null && Object.keys(favoriteUsers).length > 0 ? (\n            <List celled styleName=\"fav-list\">\n              {Object.values(_.orderBy(favoriteUsers, ['name'])).map(user => (\n                <List.Item key={user.identifier} styleName=\"fav-item\">\n                  <div styleName=\"list-flex\">\n                    <div>\n                      <span>{user.name}</span>\n                      <br />\n                      <TooltipIfTruncated>\n                        <span styleName=\"detail\">{user.detail}</span>\n                      </TooltipIfTruncated>\n                    </div>\n                    <Popup\n                      trigger={\n                        <Icon\n                          styleName=\"delete-button\"\n                          name=\"close\"\n                          onClick={() => deleteFavoriteUser(user.userId)}\n                          link\n                        />\n                      }\n                      content={Translate.string('Remove from favorites')}\n                      position=\"bottom center\"\n                    />\n                  </div>\n                </List.Item>\n              ))}\n            </List>\n          ) : (\n            <div styleName=\"empty-favorites\">\n              <Translate>You have not marked any user as favorite.</Translate>\n            </div>\n          )}\n        </div>\n      </div>\n      <UserSearch\n        existing={Object.values(favoriteUsers).map(u => u.identifier)}\n        onAddItems={e => e.forEach(u => addFavoriteUser(u.userId))}\n        triggerFactory={searchTrigger}\n      />\n    </div>\n  );\n}\n\nFavoriteUserManager.propTypes = {\n  userId: PropTypes.number,\n};\n\nFavoriteUserManager.defaultProps = {\n  userId: null,\n};\n","var baseOrderBy = require('./_baseOrderBy'),\n    isArray = require('./isArray');\n\n/**\n * This method is like `_.sortBy` except that it allows specifying the sort\n * orders of the iteratees to sort by. If `orders` is unspecified, all values\n * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n * descending or \"asc\" for ascending sort order of corresponding values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @param {string[]} [orders] The sort orders of `iteratees`.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 34 },\n *   { 'user': 'fred',   'age': 40 },\n *   { 'user': 'barney', 'age': 36 }\n * ];\n *\n * // Sort by `user` in ascending order and by `age` in descending order.\n * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n */\nfunction orderBy(collection, iteratees, orders, guard) {\n  if (collection == null) {\n    return [];\n  }\n  if (!isArray(iteratees)) {\n    iteratees = iteratees == null ? [] : [iteratees];\n  }\n  orders = guard ? undefined : orders;\n  if (!isArray(orders)) {\n    orders = orders == null ? [] : [orders];\n  }\n  return baseOrderBy(collection, iteratees, orders);\n}\n\nmodule.exports = orderBy;\n"],"names":["FavoriteManager","userId","FavoriteUserManager","FavoriteCatManager","favoriteCats","setFavoriteCats","useState","loading","setLoading","getFavoriteCats","useCallback","async","res","indicoAxios","categoryFavoriteURL","user_id","error","handleAxiosError","data","useEffect","className","Loader","active","inline","Object","keys","length","List","celled","values","map","cat","key","id","href","url","target","rel","title","chain_titles","slice","join","Popup","trigger","Icon","name","onClick","category_id","deleteFavoriteCat","link","content","Translate","position","favoriteUsers","addFavoriteUser","deleteFavoriteUser","useFavoriteUsers","user","identifier","detail","existing","u","onAddItems","e","forEach","triggerFactory","triggerProps","Button","window","setupFavoriteSelection","ReactDOM","document","getElementById","propTypes","PropTypes","defaultProps","baseOrderBy","isArray","module","exports","collection","iteratees","orders","guard","undefined"],"sourceRoot":""}